apiVersion: crd.chenshaowen.com/v1
kind: Task
metadata:
  name: docker-clear
  namespace: default
spec:
  desc: Docker Clear
  steps:
    - name: Docker system prune
      script: docker system prune -f
      allowfailure: true
    - name: Clear none image
      script: docker rmi $(docker images | grep "none" | awk '/ / { print $3 }')
      allowfailure: true
    - name: Clear dangling image
      script: docker rmi $(docker images --filter "dangling=true" -q --no-trunc)
      allowfailure: true
